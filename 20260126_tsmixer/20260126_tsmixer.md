# TSMixer: Time-Series Mixer for Time Series Forecasting

## 概要

TSMixerは時系列予測のためのMLP（Multi-Layer Perceptron）ベースのアーキテクチャ。
時間軸と特徴量軸の両方向にMixingを行うことで、効率的に時系列の特徴を捉える。

論文: [TSMixer: An All-MLP Architecture for Time Series Forecasting](https://arxiv.org/abs/2303.06053)

## アーキテクチャ

### ResBlock（残差ブロック）

各残差ブロックは以下の2つのMixing操作で構成される：

1. **Temporal Mixing**: 時間軸方向のMLP
   - 入力: `[Batch, Time, Channel]`
   - Transpose → Dense → GELU → Transpose
   - 各チャネルに対して時間方向の依存関係を学習

2. **Feature Mixing**: 特徴量軸方向のMLP
   - 入力: `[Batch, Time, Channel]`
   - Dense → GELU → Dense
   - 各時点に対してチャネル間の依存関係を学習

各Mixing操作の前にRMSNormを適用し、残差接続で安定化。

### 全体構成

```
Input [B, T_in, C]
    ↓
ResBlock × N
    ↓
(Optional) Channel Selection
    ↓
Transpose → Dense → Transpose
    ↓
Output [B, T_out, C]
```

## 実装

- フレームワーク: JAX + Flax NNX
- 正規化: RMSNorm
- 活性化関数: GELU
- PEP 723対応（`uv run`で単一ファイル実行可能）

### 実行方法

```bash
uv run 20260126_tsmixer.py
```

### ハイパーパラメータ

| パラメータ | デフォルト値 | 説明 |
|-----------|-------------|------|
| `input_length` | 96 | 入力シーケンス長 |
| `pred_length` | 24 | 予測シーケンス長 |
| `n_channels` | 7 | チャネル数 |
| `n_blocks` | 2 | 残差ブロック数 |
| `ff_dim` | 64 | Feature Mixing隠れ層次元 |
| `dropout_rate` | 0.1 | Dropout率 |

## 参考

- [Google Research TSMixer](https://github.com/google-research/google-research/tree/master/tsmixer)
- [arXiv:2303.06053](https://arxiv.org/abs/2303.06053)
